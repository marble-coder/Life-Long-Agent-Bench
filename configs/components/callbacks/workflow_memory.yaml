# Workflow Memory Callback Configuration
# 基于 AWM (Agent Workflow Memory) Online 方法
# 使用 Agent 当前的 LanguageModel 进行自归纳

db_bench_workflow_memory_callback:
  module: src.callbacks.instance.db_bench_workflow_memory_callback.DBBenchWorkflowMemoryCallback
  parameters:
    # 归纳频率：每 N 个样本归纳一次 workflow
    induction_frequency: 1
    
    # 最多保留的 workflow 数量
    max_workflows: 16
    
    # 归纳所需的最少成功样本数
    min_success_samples: 1
    
    # 用于归纳的最大示例数（避免 prompt 过长）
    max_examples_for_induction: 10
    
    # Workflow 保存文件名
    workflow_file_name: "workflows.txt"
    
    # 归纳时的推理配置（直接设置，优先级更高）
    inference_config_dict:
      do_sample: false      # 确定性输出（与 AWM 一致）
      num_beams: 1
      max_new_tokens: 2048
    
    # 是否在归纳时使用之前的 workflows 作为参考（AWM 不使用）
    use_previous_workflows: false
    
    # Prompt 文件路径
    instruction_file: "src/prompts/db_bench/workflow_induction_instruction.txt"
    one_shot_file: "src/prompts/db_bench/workflow_induction_one_shot.txt"
